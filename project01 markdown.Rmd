---
title: "From Cambodia to the Soviet Union: What Factors Influence the Probability of Death for Members of Authoritarian Regimes?"
author: "Katrin Aug, Leonhard Gruber, Samuel Hashem Zehi, Michaela Preclikova, Dominik Ruso"
date: "12/02/2021"
output: pdf_document
bibliography: bibs.bib
nocite: '@*'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
# Introduction

(Leo)

# Model Specification

In this section, we give a short overview on how the model was constructed, as well as brief justifications as to why some variables are included. The variable selection is based on variables of interest, rather than trying to maximize the predictive power of the model. The dummy for the country in which the regime is, or was, located. There might be cultural reasons why countries in Latin America or Asia might differ from countries in Europe. Furthermore, the duration of the regime is included, as it might be the case that regimes that have been in power for longer have an increasing effect on the probability of death for its members, simply due to being longer in power giving more chances to die, either natural or not. Related to this, the demeaned end year of the regime is included, as the possibility of time trends seems plausible. E.g.\ when regimes were overturned 100 years ago, the population might have been less averse to peaceful transitions. An earlier version of this model included the start year, however, the variance inflation factor (VIF) on the coefficient was relatively large, compared to the others, so it was excluded from the model. End-of-regime two-year average GDP growth is included, as a worse economic situation might lead to a more desperate population, which in turn might lead to increased propensity of a more violent approach to overturning the current regime. Lastly, all other variables are included simply out of interest, not due to an assumption on the sign and size of the partial correlations with the outcome variable. 

# Results and Interpretation

\begin{table}[!t] \centering 
  \caption{Logistic Regression Results} 
  \label{} 
\begin{tabular}{@{\extracolsep{5pt}}lc lc} 
\\[-1.8ex]\hline 
\hline \\[-1.8ex] 
 & \multicolumn{1}{c}{\textit{Dependent variable:}} &  & \multicolumn{1}{c}{\textit{Dependent variable:}} \\ 
\cline{2-2} \cline{4-4} 
\\[-1.8ex] & Death Dummy & & Death Dummy \\ 
\hline \\[-1.8ex] 
 Europe Dummy & $-$1.060 &  Regime Duration & $-$0.002 \\ 
  & (0.575) &   & (0.012) \\ 
  & \\ 
 Female Dummy & $-$15.560 &  Age at Regime Start & 0.010 \\ 
  & (723.003) &   & (0.014) \\  
  & \\ 
 Tenure in Regime & 0.035 &  2Y GDP Growth$^1$ & $-$0.206 \\
  & (0.014) &  & (0.055) \\
  & \\ 
 Economist Dummy & $-$0.433 &  Military Dummy & $-$0.157 \\ 
  & (0.756) &   & (0.467) \\ 
  & \\ 
 Regime End & 0.057 &  Constant & $-$2.073 \\
  & (0.021) &   & (0.842) \\ 
  & \\ 
  \hline \\[-1.8ex] 
Observations & 721 & Log Likelihood & $-$245.020 \\ 
McFadden R$^2$ & 0.091 & & \\ 
\hline 
\hline \\[-1.8ex] 
\multicolumn{4}{l}{\textit{Note:} \vtop{\hbox{\strut Standard errors of coefficients in round brackets.}}} \\
\multicolumn{4}{l}{\quad\quad\,\,\, \vtop{\hbox{\strut $^1$Two-year GDP growth measured in the last two years of the respective regimes.}}}
\end{tabular} 
\end{table}



(Michaela)
  \begin{itemize}
    \item insignificant coefficient on economists due to only 3\% of the sample being economists, and approx.\ 10\% are military members. Economists appear to have a \emph{clearer} effect compared to military, but still neither effect is significant
    \item 2Y growth, tenure, regime end (deviation from the mean end-year) seem like the largest drivers, all three have larger variations (not binary variables)
    \item for the presentation: significance can be checked approximately by $coefficient / standard\ error \geq 2$, maybe some finance guys don't know that and I don't include stars for the significance level
    \item $\mathbb P\text{r}(\text{death}_{Hitler} = 1 \mid \mathbf x_{Hitler})=11.76\%$, so if we observe an infinite amount of Hitlers across identical universes, then only 11.76\% of them would be predicted to die during/at the end of their regimes (maybe keep this part for the presentation rather than the handout)
    \item $\mathbb P\text{r}(\text{death}_{Goebbles} = 1 \mid \mathbf x_{Goebbles})=10.86\%$
    \item still need to find 2-3 suitable candidates for calculating the predicted probabilites (maybe Pol Pot?)
  \end{itemize}
(Katrin and Dominik)

# Model Diagnostics and Issues

Correlation between the variables leads to inflated standard errors on the respective coefficients, this multiplicative term on the standard errors is the VIF, where the variances are now defined by
  \begin{align*}
  \sigma^2_{\hat{\beta}_i} = n^{-1} \left[ \frac{1}{1-\rho^2_{\mathbf X_i,\mathbf X_j}} \right] \frac{\sigma_{\epsilon}^2}{\sigma_{\mathbf X_i}^2}.
  \end{align*}
None of the coefficients exhibit a VIF value that seems to lead to any larger concerns, using a critical value of 10 on the determination for problematic imperfect multicollinearity. However, any factor larger than one may be an issue in weak models, such as is the case here. As is denoted in Table 1, the McFadden R$^2$ is 0.091, so the model appears to have some explanatory power. To put this in further context, the hit-rate of the model, using a cutoff value of 0.5, is 88.07\%, compared to a hit-rate of 87.66\% when simply guessing the most likely outcome of not dying. One issue with such a model is, per definition, that external validity is not given, as we pre-select for being part of an authoritarian regime. Furthermore, the inclusion of variables specific for the regime, such as the duration, don't allow for out-of-sample validation methods, only allowing for validation and calibration based on random sub-samples of this particular dataset. 

# Conclusion

The model cannot capture a lot of the country-specific and time-specific factors which drive the unobserved dependent variable, at least given the data available. Thus, we are somewhat limited in the conclusions we are able to draw from this model. However, within this model, the first of three main drivers of the variation of the death probability, the economic growth rates immediately before the regime falls, which negatively influences the unobserved outcome variable. Secondly, the year in which the regime fell, which has a positive sign on the coefficient, and lastly the tenure of the individual member in their respective regime, which also has a positive coefficient.
\newpage

# Project Code

```{r l1, fig.height=5, fig.width=6, message=FALSE, warning=FALSE}
# clear workspace
rm(list = ls())

# load needed libraries
library(readr)
library(pscl)
library(car)
library(pROC)
library(stargazer)

# read dataset
data <- read_csv("C:/Users/samue/Downloads/Studium/Economics (Master - Vienna)/1. Semester/Microeconometrics/Project/Overview.csv")

# check if import worked
head(data)
head(data$ELITE_NAME)
table(data$ELITE_EXITFATE)
table(data$ELITE_EXITTYPE)


# create dummy for death during regime or at end
dim(data); n <- dim(data)[1]
death1 <- rep(1,n) 

# dummy for first type of death
for(i in 1:n){
  death1[i] <- ifelse(data$ELITE_EXITTYPE[i] != 'Demotion' 
                      && data$ELITE_EXITTYPE[i] != 'Expulsion'
                      && data$ELITE_EXITTYPE[i] != 'Death- natural'
                      && data$ELITE_EXITTYPE[i] != 'Regime Change'
                      && data$ELITE_EXITTYPE[i] != 'Resignation',1,0)}
table(death1)

# dummy for second type of death
death2 <- rep(1,n)
for(i in 1:n){
  death2[i] <- ifelse(data$ELITE_EXITFATE[i] == 'Execution',1,0)
}
table(death2)

# merge dummies
a <- which(death2==1)
b <- which(death1==1)
c <- c(a,b)
death <- rep(0,n)
death[c] <- 1
table(death)

# dummy for country being in europe
EUROPE <- rep(0,n)
for(i in 1:n){
  EUROPE[i] <- ifelse(data$STATE[i] == 'Germany' || data$STATE[i] == 'Poland'
                   || data$STATE[i] == 'East Germany' || data$STATE[i] == 'Hungary'
                   || data$STATE[i] == 'Norway' || data$STATE[i] == 'Romania'
                   || data$STATE[i] == 'Soviet Union',1,0)
}
table(EUROPE)

# dummy for military as occumpation outside of regime
MIL <- rep(0,n)
for(i in 1:n){
  MIL[i] <- ifelse(data$ELITE_OCCUPATION[i] == 'Soldier' 
                   || data$ELITE_OCCUPATION[i] == 'State Security'
                   || data$ELITE_OCCUPATION[i] == 'Army officer'
                   || data$ELITE_OCCUPATION[i] == 'Naval officer'
                   || data$ELITE_OCCUPATION[i] == 'Military Police officer'
                   || data$ELITE_OCCUPATION[i] == 'Police officer'
                   || data$ELITE_OCCUPATION[i] == 'Air Force Officer'
                   || data$ELITE_OCCUPATION[i] == 'Air Force officer',1,0)
}
table(MIL)

# dummy for economists
ECON <- rep(0,n)
for(i in 1:n){
  ECON[i] <- ifelse(data$ELITE_OCCUPATION[i] == 'Economist' 
                    || data$ELITE_OCCUPATION[i] == 'economist',1,0)
}
table(ECON)

# create function to extract date from string
substrRight <- function(x, n){
  substr(x, nchar(x)-n+1, nchar(x))
}

# get regime end year
END <- data$REG_END
END <- substrRight(END, 4)
END <- as.numeric(END)
table(END)

# get regime start year
START <- as.numeric(substrRight(data$REG_START, 4))
table(START)

# take care of regimes that have not ended
END <- ifelse(is.na(END),2020,END)
table(END)

# variable for regime duration
DURATION <- END-START
table(DURATION)

# standardize regime start year
mean(START)
START <- START-mean(START)

mean(END)
END <- END - mean(END)

#View(data)



# make data numeric for the model
death <- as.numeric(death)
ELITE_FEMALE <- as.numeric(data$ELITE_FEMALE)
ELITE_ENTERAGE <- as.numeric(data$ELITE_ENTERAGE)
ELITE_RETENURE <- as.numeric(data$ELITE_RETENURE)
EC_GR_2Y <- as.numeric(data$EC_GR_2Y)

# create dataset only based on relevant variables
data0 <- cbind(data$ELITE_NAME,death,EUROPE,START,DURATION,ELITE_FEMALE,
               ELITE_ENTERAGE,ELITE_RETENURE,EC_GR_2Y,ECON,MIL,END)
data <- cbind(death,EUROPE,START,DURATION,ELITE_FEMALE,ELITE_ENTERAGE,
              ELITE_RETENURE,EC_GR_2Y,ECON,MIL,END)

# get vectors for specific people:
hitler <- c(1,data[21,-c(1,3)])
# check if person is correct
data0[21,8] == data[21,7]

goebbles <- c(1,data[13,-c(1,3)])

# check dimenstion for later calculations
length(hitler)
t(rep(1,length(hitler)))%*%hitler



data <- as.data.frame(data)
data0 <- as.data.frame(data0)
data0 <- na.exclude(data0)
#View(data0)

# remove NAs
data <- na.exclude(data)

#View(data)


# logit model
model1 <- glm(death ~ EUROPE+START+DURATION+ELITE_FEMALE+ELITE_ENTERAGE
              +ELITE_RETENURE+EC_GR_2Y+ECON+MIL,
    family = binomial(link = 'logit'), data=data)
summary(model1)

# pseudo R2s
pR2(model1)

# variance inflation factors
vif(model1)

# cor(data) shows correlations across all variables
cor(EUROPE,START)

# model without START
model2 <- glm(death ~ EUROPE+DURATION+ELITE_FEMALE+ELITE_ENTERAGE+ELITE_RETENURE
              +EC_GR_2Y+ECON+MIL+END,
    family = binomial(link = 'logit'), data = data)
summary(model2)
pR2(model2)

roc(data$death,predict.glm(model2,type='response'),plot=TRUE)

vif(model2)

# get hit rate of the model with a 0.5 cutoff
cutoff <- 0.5
# get predicted probabilities
latent_pred <- predict.glm(model2,type = 'response')
# get binary result from the cutoff
latent_bin <- ifelse(latent_pred >= cutoff,1,0)
# hitrate 
mean(latent_bin==data$death)
# percentage by just guessing more likely outcome
1-mean(data$death)

# maximal predicted probability
max(latent_pred)
densityPlot(latent_pred, ylab = 'Density', 
            xlab = 'Predicted Probability',
            main = 'Density Plot of Latent Probability of Death')


# check coefficient vector lengths
length(model2$coefficients);length(hitler)
# check vectors for matching variables
hitler
model2$coefficients
# get probabilities
Pr_hitler <- 1/(1+exp(-t(model2$coefficients)%*%(hitler)))
Pr_hitler
Pr_goebbles <- 1/(1+exp(-t(model2$coefficients)%*%(goebbles)))
Pr_goebbles
# verify that the model would predict wrongly
latent_bin[21]==data$death[21]
latent_bin[13]==data$death[13]
# Get the predicted probabilities for Hitler, Goebbels, someone from 
# SE Asia (no external war), Stalin (communist).

# check for percentage of economists and military
mean(na.omit(data$ECON)); mean(na.omit(data$MIL))

mean(na.omit(data$death))
```


# References